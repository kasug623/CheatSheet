# TOC
- [Environment](#environment)


# Environment
- [TOC](#toc)
- [Environment](#environment)
- [Intellignence](#intellignence)
  - [Microsoft security intelligence](#microsoft-security-intelligence)
  - [CAPEC](#capec)
- [File](#file)
  - [ClamAV(clamscan)](#clamavclamscan)
- [TrID](#trid)
- [`pestr`](#pestr)
- [`Detect It Easy`](#detect-it-easy)
- [`peframe`](#peframe)
- [`capa`](#capa)
- [`Speakeasy`](#speakeasy)
  - [oledump](#oledump)
  - [olevba](#olevba)
- [`pcode2code`](#pcode2code)
- [`pcodedmp`](#pcodedmp)
- [vs.Obfuscation](#vsobfuscation)
  - [javascript](#javascript)
    - [de4js](#de4js)
- [Windows Powershell](#windows-powershell)
- [`SpiderMonkey`](#spidermonkey)
- [Debugger](#debugger)
- [vs. Shellcode](#vs-shellcode)
  - [Sysinternals \> Strings](#sysinternals--strings)
  - [StringSifter](#stringsifter)
  - [FLOSS](#floss)
  - [Yara](#yara)
- [`yara-rules`](#yara-rules)
- [`runsc32`](#runsc32)
- [`scdbgc`](#scdbgc)
- [`ViperMonkey`](#vipermonkey)
- [`js-beautify`](#js-beautify)
- [`UPX`](#upx)
- [`bbcrack`](#bbcrack)
- [`strdeob.pl`](#strdeobpl)
- [`peepdf`](#peepdf)
  - [install](#install)
  - [usage](#usage)
- [qpdf](#qpdf)
  - [usage](#usage-1)
    - [1. Encrypting a PDF file](#1-encrypting-a-pdf-file)
    - [2. Decrypting a PDF file:](#2-decrypting-a-pdf-file)
    - [3. Merging PDF files:](#3-merging-pdf-files)
    - [4. Splitting a PDF file:](#4-splitting-a-pdf-file)

# Intellignence
## Microsoft security intelligence
https://www.microsoft.com/en-us/wdsi/threats

## CAPEC
https://capec.mitre.org/  
調査対象がどのCAPEC番号かは、調査対象を詳細に見て攻撃テクニックのキーワードとなる技術でCAPECサイトで検索する。  
検索した後、CAPECサイトの詳細情報から該当するものを見つける。

# File
## ClamAV(clamscan)
winchecksec from release on github

# TrID
```zsh
$ trid foo.doc
```

# `pestr`
`pestr` is a command similar to `strings` and only targets PE file.  
The difference between `strigns` and `pestr` is that `pestr` does "`strings` and `strings -a` behavior" at one time.
```zsh
$ pestr foo.exe | less
```

# `Detect It Easy`
launch command for Detect It Easy
```zsh
$ deic foo.exe
```
# `peframe`
extract PE file's properties
```zsh
$ peframe foo.exe | less
```
# `capa`
```zsh
$ capa foo.exe
$ capa -vv foo.exe
```
# `Speakeasy`
```zsh
$ run_speakeasy.py -t foo.exe -o speakeasy.json 2> speakeasy.txt
```

## oledump
python3

## olevba
https://github.com/decalage2/oletools/wiki/olevba
```zsh
$ olevba foo.doc > foo.olevba
$ olevba foo.docm
$ olevba foo.xlsm --decode
```
# `pcode2code`
```zsh
$ pcode2code foo.docm | more
```
# `pcodedmp`
```zsh
$ pcodedmp foo.docm > foo.pcodedmp
$ code foo.pcodedmp
```

# vs.Obfuscation
## javascript
### de4js
https://lelinhtinh.github.io/de4js/

# Windows Powershell
```zsh
$ cscript foo.js
```
# `SpiderMonkey`
```zsh
$ js -f ./foo.js
$ js -f ./foo.js -f piyo.js > hoge.js
$ more hoge.js
```

# Debugger
- Ruck Debugger

# vs. Shellcode
## Sysinternals > Strings
```zsh
# Command Prompt
$ strings64 -nobanner test.bin | more
```
-nobanner: sup@ress noisy banner

## StringSifter 
https://github.com/mandiant/stringsifter
```zsh
$ strings64 -nobanner test.bin | rank_strings | more
```
## FLOSS
```zsh
$ floss -f sc64 --no static -- test.bin
```
final `--` : the mark for the end of options
```zsh
$ floss -f sc32 -v --no static -- test.bin
```
```zsh
$ floss foo.exe
$ floss foo.exe > foo.txt
$ code foo.txt
```
## Yara
https://github.com/InQuest/awesome-yara  
YARA Forge: https://yarahq.github.io/
```zsh
$ yara yara-rules-full.tar test.exe
```

# `yara-rules`
```
$ yara-rules foo.bin
```

# `runsc32`
```zsh
$ runsc32 -f foo.bin
$ runsc32 -f foo.bin -o 0x4A -d piyo.doc -n
```
# `scdbgc`
```zsh
$ scdbgc /f foo.bin /s -1
$ scdbgc /f foo.bin /s -1 /foff 3B
$ scdbgc /f foo.bin /s -1 /foff 3B /fopen piyo.doc /norw
```
# `ViperMonkey`
```
$ vmonkey foo.doc > foo.vmonkey
$ code foo.vmonkey
```

# `js-beautify`
```zsh

$ js-beautify foo.js > foo-b.js
$ code foo-b.js
```
# `UPX`
```zsh
$ upx -d foo.exe
```

# `bbcrack`
```zsh
$ bbcrack -l 1 foo.dll
```
# `strdeob.pl`
```zsh
$ strdeob.pl foo.exe
```

# `peepdf`
`peepdf` is a python-based tool that can be used to analyze and manipulate PDF files in a security context. It can be used to identify potential vulnerabilities in PDF files, such as malware or malicious JavaScript code. 
## install
```zsh
$ pip install peepdf
```
## usage
```zsh
$ peepdf <PDF_file>
``` 
- Analyze PDF file  
Once you have launched `peepdf`, you can use various commands to analyze the PDF file. For example, you can use the info command to view information about the PDF file, such as its version, the number of objects, the encryption status, etc.
- Identify vulnerabilities  
You can use `peepdf` to identify potential vulnerabilities in PDF files, such as malware or malicious JavaScript code. For example, you can use the js command to view any JavaScript code contained in the PDF file, and the streams command to view the contents of any streams in the file.
- Modify PDF file  
You can also use peepdf to modify the contents of a PDF file. For example, you can use the js command to add or remove JavaScript code from the file, and the streams command to add or modify the contents of streams in the file.
- Note: Keep in mind that using peepdf or any other tool to modify a PDF file can potentially cause the file to become corrupted or introduce security vulnerabilities, so be cautious when using these tools and always make backups of your files.

# qpdf
`QPDF` is a command-line tool that is commonly used in the cyber security field for manipulating PDF files. It can be used for tasks such as encrypting and decrypting PDF files, adding and removing password protection, and merging or splitting PDF files. Here's how you can use some of the most common features of qpdf:
## usage
### 1. Encrypting a PDF file  
```
qpdf --encrypt foo_password 128 -- file.pdf encrypted_file.pdf
```
In this command, "foo_password" is the password used to encrypt the file, and "128" is the encryption strength in bits.
### 2. Decrypting a PDF file:
```
$ qpdf --decrypt --password=foo_password encrypted_file.pdf decrypted_file.pdf
```
### 3. Merging PDF files:
```
$ qpdf --empty --pages file1.pdf file2.pdf file3.pdf -- file_merged.pdf
```
### 4. Splitting a PDF file:
```
$ qpdf --split=2 --file.pdf split_file
```
In this command, "2" is the number of pages in each split file.